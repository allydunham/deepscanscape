<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot a new study on the deep mutational landscape — plot_landscape • DeepScanScape</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Plot a new study on the deep mutational landscape — plot_landscape" />
<meta property="og:description" content="Project new data onto the deep mutational landscape derived from the combined data, viewed in UMAP space. This view
allows you to determine if new data follows the expected distribution and compare it with the average properties for
positions in the same regions of the landscape. This can give insights into the likely properties of positions in the
new protein." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DeepScanScape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9042</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/deepscanscape.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/allydunham/deepscanscape/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot a new study on the deep mutational landscape</h1>
    <small class="dont-index">Source: <a href='https://github.com/allydunham/deepscanscape/blob/master/R/visualise.R'><code>R/visualise.R</code></a></small>
    <div class="hidden name"><code>plot_landscape.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Project new data onto the deep mutational landscape derived from the combined data, viewed in UMAP space. This view
allows you to determine if new data follows the expected distribution and compare it with the average properties for
positions in the same regions of the landscape. This can give insights into the likely properties of positions in the
new protein.</p>
    </div>

    <pre class="usage"><span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>x</span>, feature <span class='op'>=</span> <span class='cn'>NULL</span>, highlight <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p><code><a href='deep_mutational_scan.html'>deep_mutational_scan</a></code>.</p></td>
    </tr>
    <tr>
      <th>feature</th>
      <td><p>String name of a feature to project onto the background landscape. This can be a numeric column from
the <code><a href='deep_landscape.html'>deep_landscape</a></code> dataset or the special values "count" or "cluster", which map the position density
and most common subtype category respectively.</p></td>
    </tr>
    <tr>
      <th>highlight</th>
      <td><p>Positions to label. This can be a vector for deep_mutational_scan objects with a single study or
a named list of such vectors if multi_study == TRUE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='https://ggplot2.tidyverse.org/reference/ggplot2-package.html'>ggplot2</a></code> plot.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Points represent positions from the new protein(s), positioned based on predicted UMAP coordinates from the
combined landscape model. These are plotted on top of the whole combined landscape, which is represented as grey
points when no feature is used and coloured hexagonal bins when one is. These bins are coloured based on the mean
value of the chosen feature for all points that fall within the hexagon for numerical landscape features.
If the chosen feature is a FoldX Gibbs Free Energy prediction values are initially clamped to -5 &lt;= x &lt;= 5 because
larger values lead to difficult to read scales and are generally thought to represent program quirks rather than
real biology. There are also two special values for feature "count" and "cluster", which colour bins by the
number of landscape positions and the most common cluster type, respectively.</p>
<p>The input data is annotated using <code><a href='annotate.html'>annotate</a></code> if it is not already, based on the <code>annotated</code> flag
for deep_mutational_scan objects and the presence of the required <code>umap1/2</code> columns for data frames. It is
better to save the results of <code>annotate</code> if doing multiple downstream analyses because can be a relatively slow
operation.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>dms</span> <span class='op'>&lt;-</span> <span class='fu'>deepscanscape</span><span class='fu'>::</span><span class='va'><a href='deep_scans.html'>deep_scans</a></span><span class='op'>$</span><span class='va'>p53</span>

<span class='co'># Plot point positions</span>
<span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>dms</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: deep_mutational_scan is not annotated. Annotating using annotate().</span></div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='co'># Plot against mean conservation</span>
<span class='va'>dms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='annotate.html'>annotate</a></span><span class='op'>(</span><span class='va'>dms</span><span class='op'>)</span>
<span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>dms</span>, feature <span class='op'>=</span> <span class='st'>"mean_sift"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_landscape-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plot against spceial features</span>
<span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>dms</span>, feature <span class='op'>=</span> <span class='st'>"count"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_landscape-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>dms</span>, feature <span class='op'>=</span> <span class='st'>"cluster"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_landscape-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Plot multiple studies</span>
<span class='va'>comb_dms</span> <span class='op'>&lt;-</span> <span class='fu'><a href='bind_scans.html'>bind_scans</a></span><span class='op'>(</span><span class='va'>deep_scans</span>, annotate_missing <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>comb_dms</span>, feature <span class='op'>=</span> <span class='st'>"total_energy"</span><span class='op'>)</span>
</div><div class='img'><img src='plot_landscape-4.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># Highlight Positions</span>
<span class='va'>highlight</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>`Hietpas Hsp90`<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span>, `Kotler p53`<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>30</span>, <span class='fl'>50</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plot_landscape</span><span class='op'>(</span><span class='va'>comb_dms</span>, feature <span class='op'>=</span> <span class='st'>"cluster"</span>, highlight <span class='op'>=</span> <span class='va'>highlight</span><span class='op'>)</span>
</div><div class='img'><img src='plot_landscape-5.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alistair Dunham.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


